{% extends "base.html" %}

{% block content %}
<div class="container my-5">
    <h2 class="text-center">User Profile</h2>

    <!-- Display current profile picture -->
    <div class="text-center">
        <img src="{{ url_for('static', filename='uploads/' + (user.profile_pic if user.profile_pic else 'images/default-profile.jpg')) }}" alt="Profile Picture" class="img-fluid rounded-circle" style="width: 150px; height: 150px;">
    </div>

    <!-- Profile Form -->
    <form method="POST" enctype="multipart/form-data">
        <!-- Disabled Name, Email, Phone fields -->
        <div class="form-group">
            <label for="name">Name</label>
            <input type="text" class="form-control" id="name" value="{{ user.username }}" disabled>
        </div>
        <div class="form-group">
            <label for="email">Email</label>
            <input type="email" class="form-control" id="email" value="{{ user.email }}" disabled>
        </div>
        <div class="form-group">
            <label for="phone">Phone</label>
            <input type="text" class="form-control" id="phone" name="phone" value="{{ user.phone }}">
        </div>

        <!-- Editable fields -->
        <div class="form-group">
            <label for="address">Address</label>
            <textarea class="form-control" id="address" name="address" rows="3">{{ user.address }}</textarea>
        </div>

        <div class="form-group">
            <label for="pincode">Pincode</label>
            <input type="text" class="form-control" id="pincode" name="pincode" value="{{ user.pincode }}">
        </div>

        <!-- Display service expertise and experience for professionals -->
        {% if user.role == 'professional' %}
            <div class="form-group">
                <label for="service_expertise">Service Expertise</label>
                <input type="text" class="form-control" id="service_expertise" name="service_expertise" value="{{ user.service_expertise }}">
            </div>
            <div class="form-group">
                <label for="experience">Experience Level</label>
                <input type="text" class="form-control" id="experience" name="experience" value="{{ user.experience }}">
            </div>
            <div class="form-group">
                <label for="about">About</label>
                <textarea class="form-control" id="about" name="about" rows="3">{{ user.about }}</textarea>
            </div>
        {% endif %}

        <!-- Upload Profile Picture -->
        <div class="form-group">
            <label for="profile_pic">Upload New Profile Picture</label>
            <input type="file" class="form-control-file" id="profile_pic" name="profile_pic">
        </div>

        <button type="submit" class="btn btn-primary">Update Profile</button>
        
        <!-- Back to Dashboard Button -->
        <div class="text-center mt-4">
            {% if user.role == 'customer' %}
                <a href="{{ url_for('customer_dashboard') }}" class="btn btn-secondary">Back to Customer Dashboard</a>
            {% elif user.role == 'admin' %}
                <a href="{{ url_for('admin_dashboard') }}" class="btn btn-secondary">Back to Admin Dashboard</a>
            {% elif user.role == 'professional' %}
                <a href="{{ url_for('professional_dashboard') }}" class="btn btn-secondary">Back to Professional Dashboard</a>
            {% endif %}
        </div>
    </form>
</div>
{% endblock %}
